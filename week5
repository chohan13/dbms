create database week5;
use week5;

create table DEPT(
  DEPTNO int,
  DNAME varchar(20) ,
  DLOC varchar(30),
  primary key(DEPTNO) 
  
  


);

insert into  DEPT VALUES(1,'CS',"BANGALORE");
insert into  DEPT VALUES(2,"IS","HYDERBAD");
insert into  DEPT VALUES(3,"BLOCKCHAIN","DELHI");
insert into  DEPT VALUES(4,"WEB-DEVELOPMENT","MYSORE");
insert into  DEPT VALUES(5,"CRYPTOGRAPHY","BANGALORE");




create table EMPLOYEE(
EMPNO int,
 EMPNAME varchar(20),
 MGR_NO int,
 HIREDATE VARCHAR(10),
 SAL INT,
 DEPTNO INT,
 primary key(EMPNO),
 FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO) ON DELETE CASCADE ON UPDATE CASCADE
 
); 


INSERT INTO EMPLOYEE VALUES(1,"AMSHU",3,"10-10-2022",500000,1);
INSERT INTO EMPLOYEE VALUES(2,"ANOSHOR",1,"11-11-2022",100000,2);
INSERT INTO EMPLOYEE VALUES(3,"AKRAM",1,"10-10-2022",250000,3);
INSERT INTO EMPLOYEE VALUES(4,"AMISH",2,"11-3-2021",300000,4);
INSERT INTO EMPLOYEE VALUES(5,"AISHA",3,"12-9-2021",890000,5);

CREATE TABLE PROJECT(
    PNO INT,
    PLOC VARCHAR(30),
    PNAME VARCHAR(50),
    PRIMARY KEY(PNO)

);

INSERT INTO PROJECT VALUES(1,"BANGALORE","PROJECT WEB-DEV");
INSERT INTO PROJECT VALUES(2,"HYDERBAD","CREATION OF SIMPLE BLOCKCHAIN");
INSERT INTO PROJECT VALUES(3,"DELHI","MARKETING OF A PRODUCT");
INSERT INTO PROJECT VALUES(4,"MYSORE","DEVELOPING A CLIENT SERVER");
INSERT INTO PROJECT VALUES(5,"MAGDI","HANDLING DATABASE");

CREATE TABLE INCENTIVES(
    EMPNO INT,
    INCENTIVE_DATE VARCHAR(10),
    INCENTIV_AMOUNT INT,
    PRIMARY KEY(EMPNO)
     

);

INSERT INTO INCENTIVES VALUES(1,"21-2-2023",54000);
INSERT INTO INCENTIVES VALUES(2,"23-2-2011",35000);
INSERT INTO INCENTIVES VALUES(4,"30-4-2018",45000);
INSERT INTO INCENTIVES VALUES(6,"30-5-2014",44000);
INSERT INTO INCENTIVES VALUES(5,"23-2-2021",32000);




CREATE TABLE ASSIGNED_TO(
   EMPNO INT,
   PNO INT,
   JOB_ROLE VARCHAR(20),
   primary key(EMPNO),
   FOREIGN KEY(EMPNO) REFERENCES EMPLOYEE(EMPNO) ON DELETE CASCADE ON UPDATE CASCADE,
   FOREIGN KEY(EMPNO) REFERENCES INCENTIVES(EMPNO) ON DELETE CASCADE ON UPDATE CASCADE,
   FOREIGN KEY (PNO) REFERENCES PROJECT(PNO) ON DELETE CASCADE ON UPDATE CASCADE

);
INSERT INTO ASSIGNED_TO VALUES(1,1,"SENIOR DEVELOPER");
INSERT INTO ASSIGNED_TO VALUES(2,1,"JUNIOR DEVELOPER");

INSERT INTO ASSIGNED_TO VALUES(4,3,"MARKETING SPECIALIST");
INSERT INTO ASSIGNED_TO VALUES(5,3,"MANAGER");


-- 3. Retrieve the employee numbers of all employees who work on project located in Bengaluru, Hyderabad, or Mysuru
-- 4. Get Employee ID’s of those employees who didn’t receive incentives
-- 5. Write a SQL query to find the employees name, number, dept, job_role, department location and project location who are working for a project location same as his/her department location.



-- QUERY 5

SELECT E.EMPNAME,E.EMPNO,D.DNAME,A.JOB_ROLE,D.DLOC,P.PLOC
FROM EMPLOYEE E
INNER JOIN  DEPT D
ON D.DEPTNO=E.DEPTNO
INNER JOIN ASSIGNED_TO A
ON A.EMPNO=E.EMPNO
INNER JOIN PROJECT P
ON P.PNO=A.PNO WHERE P.PLOC=D.DLOC;

-- QUERY 4

select e.empno from employee e where e.empno!= all (SELECT  E.EMPNO
FROM EMPLOYEE E 
inner join INCENTIVES I
on i.empno=e.empno)
;



-- QUERY 3

SELECT E.EMPNO
FROM EMPLOYEE E
INNER JOIN DEPT D
ON D.DEPTNO=E.DEPTNO
INNER JOIN ASSIGNED_TO A 
ON A.EMPNO=E.EMPNO
INNER JOIN PROJECT P 
ON P.PNO=A.PNO
WHERE PLOC IN ("BANGALORE","HYDERBAD","MYSORE");
